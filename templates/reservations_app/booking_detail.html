{% extends "base.html" %}

{% block content %}
<div class="booking-detail-container">
    <div class="section-header">
        <h1>Réservation #{{ booking.id }}</h1>
        <div class="booking-status {{ booking.status }}">
            {{ booking.get_status_display }}
        </div>
    </div>

    {% if messages %}
    <div class="messages">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="booking-content">
        <div class="booking-info-card">
            <h2>Informations de la réservation</h2>
            <div class="info-grid">
                <div class="info-item">
                    <span class="label">Client</span>
                    <span class="value">{{ booking.user.get_full_name }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Email</span>
                    <span class="value">{{ booking.user.email }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Date d'arrivée</span>
                    <span class="value">{{ booking.check_in|date:"d/m/Y" }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Date de départ</span>
                    <span class="value">{{ booking.check_out|date:"d/m/Y" }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Nombre d'adultes</span>
                    <span class="value">{{ booking.adults }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Nombre d'enfants</span>
                    <span class="value">{{ booking.children }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Prix total</span>
                    <span class="value price">{{ booking.total_price }}€</span>
                </div>
            </div>
        </div>

        <div class="room-info-card">
            <h2>Informations sur la chambre</h2>
            <div class="info-grid">
                <div class="info-item">
                    <span class="label">Hôtel</span>
                    <span class="value">{{ booking.room.hotel.name }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Numéro de chambre</span>
                    <span class="value">{{ booking.room.room_number }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Type de chambre</span>
                    <span class="value">{{ booking.room.room_type.get_name_display }}</span>
                </div>
                <div class="info-item">
                    <span class="label">Étage</span>
                    <span class="value">{{ booking.room.floor }}</span>
                </div>
            </div>
        </div>

        {% if booking.special_requests %}
        <div class="special-requests-card">
            <h2>Demandes spéciales</h2>
            <p>{{ booking.special_requests }}</p>
        </div>
        {% endif %}

        <div class="booking-actions">
            {% if booking.status == 'pending' %}
                {% if user == booking.user %}
                <a href="{% url 'reservations:booking-cancel' booking.pk %}" class="btn btn-danger">
                    <i class="fas fa-times"></i> Annuler la réservation
                </a>
                {% elif user == booking.room.hotel.owner %}
                <div class="owner-actions">
                    <a href="{% url 'reservations:booking-update' booking.pk %}" class="btn btn-warning">
                        <i class="fas fa-edit"></i> Modifier
                    </a>
                    <button class="btn btn-success confirm-booking" data-booking-id="{{ booking.pk }}">
                        <i class="fas fa-check"></i> Confirmer
                    </button>
                    <button class="btn btn-danger reject-booking" data-booking-id="{{ booking.pk }}">
                        <i class="fas fa-times"></i> Rejeter
                    </button>
                </div>
                {% endif %}
            {% endif %}
            <a href="{% url 'reservations:booking-list' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Retour aux réservations
            </a>
        </div>
    </div>
</div>

<style>
    .booking-detail-container {
        max-width: 1000px;
        margin: 40px auto;
        padding: 0 20px;
    }

    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }

    .booking-status {
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: 500;
    }

    .booking-status.pending {
        background-color: #fff3cd;
        color: #856404;
    }

    .booking-status.confirmed {
        background-color: #d4edda;
        color: #155724;
    }

    .booking-status.cancelled {
        background-color: #f8d7da;
        color: #721c24;
    }

    .booking-status.completed {
        background-color: #cce5ff;
        color: #004085;
    }

    .booking-content > div {
        background: white;
        border-radius: 8px;
        padding: 25px;
        margin-bottom: 30px;
        box-shadow: 0 2px 20px rgba(0,0,0,0.1);
    }

    .booking-content h2 {
        color: #003366;
        margin: 0 0 20px;
        font-size: 1.5em;
    }

    .info-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
    }

    .info-item {
        display: flex;
        flex-direction: column;
    }

    .info-item .label {
        color: #666;
        font-size: 0.9em;
        margin-bottom: 5px;
    }

    .info-item .value {
        color: #333;
        font-weight: 500;
    }

    .info-item .value.price {
        color: #28a745;
        font-size: 1.2em;
    }

    .special-requests-card p {
        color: #666;
        line-height: 1.6;
    }

    .booking-actions {
        display: flex;
        gap: 15px;
        justify-content: flex-end;
    }

    .owner-actions {
        display: flex;
        gap: 10px;
    }

    .btn {
        padding: 10px 20px;
        border-radius: 4px;
        border: none;
        cursor: pointer;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-size: 1em;
    }

    .btn-primary { background-color: #007bff; color: white; }
    .btn-secondary { background-color: #6c757d; color: white; }
    .btn-success { background-color: #28a745; color: white; }
    .btn-danger { background-color: #dc3545; color: white; }
    .btn-warning { background-color: #ffc107; color: #000; }

    @media (max-width: 768px) {
        .section-header {
            flex-direction: column;
            gap: 15px;
            text-align: center;
        }

        .booking-actions {
            flex-direction: column;
        }

        .owner-actions {
            flex-direction: column;
        }

        .btn {
            width: 100%;
            justify-content: center;
        }
    }
</style>
{% endblock %} 